{% extends "accounts/base.html" %}
{% load static %}

{% block title %}Payment{% endblock %}

{% block body %}

	<div class="limiter">
		<div class="container-login100" style="background-image: url({% static 'images/back.jpg' %});">
			<div class="wrap-login100 p-t-190 p-b-30">
    			<span class="login100-form-title p-t-20 p-b-45">Make Payments Here!</span> 
                    <form method="post">       
                    {% csrf_token %}
                        <div style="text-align:center;" class="wrap-input100 validate-input m-b-10">
                            <i class="fa fa-user"></i>
                            <label for="fullname">Full Name</label>
                            <input class="input100" type="text" id="fullname" name="fullname" placeholder="Full Name" required>
                            <span class="focus-input100"></span>
                            <span class="symbol-input100"></span>
                        </div>
                        <div style="text-align:center;" class="wrap-input100 validate-input m-b-10">
                            <i class="fa fa-user"></i>
                            <label for="email">Email</label>
                            <input class="input100" type="email" id="email" name="email" placeholder="Email" required>
                            <span class="focus-input100"></span>
                            <span class="symbol-input100"></span>
                        </div>
                        <div style="text-align:center;" class="wrap-input100 validate-input m-b-10">
                            <i class="fa fa-user"></i>
                            <label for="mobile_number">Mobile Number</label>
                            <input class="input100" type="text" id="mobile_number" name="mobile_number" placeholder="Mobile Number" required>
                            <span class="focus-input100"></span>
                            <span class="symbol-input100"></span>
                        </div>
                        <div style="text-align:center;" class="wrap-input100 validate-input m-b-10">
                            <i class="fa fa-user"></i>
                            <label for="type">Type</label>
                            <select id="type" name="type" class="input100" required>
                                <option class="input100" value="dues" name="dues">Dues</option>
                                <option class="input100" value="welfare" name="welfare">Welfare</option>
                                <option class="input100" value="special" name="special">Special Contribution</option>
                                <option class="input100" value="donation" name="donation">Donation</option>
                            </select>
                            <span class="focus-input100"></span>
                            <span class="symbol-input100"></span>
                        </div>
                        <div style="text-align:center;" class="wrap-input100 validate-input m-b-10">
                            <i class="fa fa-user"></i>
                            <label for="amount">Amount</label>
                            <input class="input100" type="number" id="amount" name="amount" placeholder="Amount" required>
                            <span class="focus-input100"></span>
                            <span class="symbol-input100"></span>
                        </div>
                        
                        <div class="container-login100-form-btn p-t-10">
                            <script src="https://js.paystack.co/v1/inline.js"></script>
                            <button class="login100-form-btn" type="submit" onclick="payWithPaystack()" >Pay</button>
                        </div>
                        <div class="text-center w-full p-t-25 p-b-230">
                            <a href="{% url 'youth:index' %}" class="txt1">Home<br></a>
                            <a href="{% url 'accounts:dashboard' %}" class="txt1">Dashboard<br></a>
					    </div>
                    </form>
            </div>
        </div>
    </div>


{% block scripts %}
<script>
  function payWithPaystack(){
      var fullname = document.getElementById("fullname").value;
      var email = document.getElementById("email").value;
      var mobile_number = document.getElementById("mobile_number").value;
      var amount = document.getElementById("amount").value;

      var handler = PaystackPop.setup({
        key: 'pk_live_6fd88f7a7e79d8ce558178692fab1f5e37293c5f',
        email: email,
        amount: amount * 100,
        currency: "GHS",
        ref: ''+Math.floor((Math.random() * 10000000000) + 1), // generates a pseudo-unique reference. Please replace with a reference you generated. Or remove the line entirely so our API will generate one for you
        metadata: {
            custom_fields: [
            {
                display_name: "Name",
                variable_name: "fullname",
                value: fullname
            },
            {
                display_name: "Mobile Number",
                variable_name: "mobile_number",
                value: mobile_number
            }
         ]
      },
      callback: function(response){
        ref = response.reference
        window.location ="{% url 'accounts:dashboard' %}";
          alert('success. transaction ref is ' + response.reference);
      },
      onClose: function(){
          alert('window closed');
      }
    });
    handler.openIframe();
  }
</script>
{% endblock scripts %}

{% endblock body %}